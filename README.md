# Energy Consumption Analysis

## Overview

**Energy Consumption Analysis** — это проект, направленный на исследование влияния погодных факторов (в первую очередь, температуры) и временных характеристик (месяц, день недели, час) на потребление электроэнергии. Проект включает этапы обработки данных, разведочного анализа (EDA), построения и оценки моделей (линейная регрессия, Random Forest, Gradient Boosting) и автоматизированного создания финального отчёта в формате Word.

## Features

- **Data Preprocessing**  
  - Преобразование данных из широкого формата (часовые показатели) в длинный формат.
  - Создание столбца `Datetime` с синхронизацией данных нагрузки и температуры.
  - Объединение данных по времени для выбранных зон и станций.

- **Exploratory Data Analysis (EDA)**  
  - Визуализация распределений, временных рядов и зависимостей между нагрузкой и температурой.
  
- **Modeling**  
  - Построение моделей: линейная регрессия, Random Forest и Gradient Boosting.
  - Внедрение лаговых признаков для учета автокорреляции во временных рядах.
  - Разделение данных по времени (time-based split) для реального сценария прогнозирования.

- **Report Generation**  
  - Автоматическая генерация отчёта в формате Word с использованием библиотеки `python-docx`.

## Project Structure

```plaintext
EnergyConsumptionAnalysis/
├── data/                     # Исходные CSV-файлы с данными (например, Load_history.csv, Temperature_history.csv)
├── data_preprocessing.py     # Модуль для загрузки, преобразования и объединения данных
├── eda.py                    # Модуль для проведения разведочного анализа (EDA)
├── modeling.py               # Модуль для построения базовой модели (линейная регрессия)
├── improved_modeling.py      # Модуль для продвинутого моделирования (Random Forest, Gradient Boosting, лаговые признаки, time-based split)
├── word_report.py            # Модуль для генерации финального отчёта в формате Word с графиками и таблицами
├── requirements.txt          # Список необходимых зависимостей для проекта
├── .gitignore                # Файл для игнорирования ненужных файлов в репозитории
└── README.md                 # Этот файл
```

## Installation

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/USERNAME/energy-consumption-analysis.git
   cd energy-consumption-analysis
   ```

2. **Создайте и активируйте виртуальное окружение:**

   ```bash
   python -m venv venv
   # Windows:
   venv\Scripts\activate
   # macOS/Linux:
   source venv/bin/activate
   ```

3. **Установите зависимости:**

   ```bash
   pip install -r requirements.txt
   ```

   *Если у вас возникнут вопросы по зависимостям, убедитесь, что в файле `requirements.txt` присутствуют основные библиотеки: pandas, numpy, matplotlib, seaborn, scikit-learn, python-docx.*

4. **Скачайте или поместите данные в папку `data/`**  
   Файлы `Load_history.csv` и `temperature_history.csv` должны находиться в папке `data/`. Если данные большие или приватные, укажите в README, откуда их можно скачать.

## Usage

### Проведение EDA

Запустите модуль `eda.py`, чтобы выполнить разведочный анализ данных:

```bash
python eda.py
```

В результате откроются окна с графиками распределения, временными рядами и другими визуализациями, демонстрирующими структуру данных.

### Построение моделей

- **Базовое моделирование:**  
  Запустите `modeling.py` для обучения модели линейной регрессии и оценки её метрик:

  ```bash
  python modeling.py
  ```

- **Продвинутое моделирование:**  
  Запустите `improved_modeling.py` для обучения моделей Random Forest и Gradient Boosting с использованием лаговых признаков и time-based split:

  ```bash
  python improved_modeling.py
  ```

### Генерация отчёта

Для автоматической генерации финального отчёта в формате Word запустите:

```bash
python word_report.py
```

После выполнения в корне проекта появится файл `report.docx` с итоговым отчётом, включающим заголовки, параграфы, таблицы и графики.

## Results

В отчёте и консольном выводе вы увидите:
- **Метрики моделей:** MSE и R² для каждой модели (линейной регрессии, Random Forest, Gradient Boosting).
- **Визуальное сравнение:** Графики фактических и прогнозируемых значений потребления электроэнергии.
- **Анализ важности признаков:** Оценка вклада температурных и временных признаков, включая лаговые.

## Contributing

Если у вас есть идеи или улучшения, вы можете создать pull request или открыть issue. Ваш вклад приветствуется!

## License

Этот проект распространяется под лицензией [MIT License](LICENSE).
